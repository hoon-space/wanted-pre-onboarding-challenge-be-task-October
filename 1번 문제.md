# 1번 문제
### 동시에 같은 `DB Table row` 를 업데이트 하는 상황을 방어하기 위해 어떻게 개발하실 건지 설명해주세요.
---


## 트랜잭션

- 트랜잭션(transaction)은 데이터베이스를 다룰 때 사용하는 작업 단위로, 데이터베이스에서 여러 작업이 동시에 같은 데이터를 다루는 작업을 서로 분리하는 단위가 된다.
- DB 테이블의 row, 즉 동일한 데이터를 업데이트 하는 경우 두 작업의 순서가 정의되어 있어야 하며, 한 트랜잭션이 수행되는 도중 프로그램 상의 장애로 인해 다른 트랜잭션이 끼어드는 경우 데이터의 훼손이 발생할 수 있다. 따라서 트랜잭션을 통해 두 작업을 분리하여, 동시에 데이터를 업데이트하는 상황을 방어해야 한다.
- 트랜잭션은 원자성, 일관성, 고립성, 지속성이라는 네 가지 성질을 지님으로써, 동시에 데이터를 다루어 발생하는 문제들을 방지할 수 있다.
    - 원자성이란, 트랜잭션 내에 포함된 작업은 전부 수행되거나, 전부 수행되지 않는 (all or nothing) 성질이다.
    - 일관성이란, 트랜잭션을 수행하기 전이나 수행한 후나 데이터베이스는 항상 일관된 상태를 유지하는 성질이다.
    - 고립성은 수행 중인 트랜잭션에 다른 트랜잭션이 끼어들어 벼녕 중인 데이터 값을 훼손하는 일이 없어야 하는 성질이다.
    - 지속성이란, 성공적으로 수행 완료한 트랜잭션이 변경한 데이터를 영구히 저장해야 하는 성질이다.
- 각 작업이 수행할 문장들을 `START RANSACTION` 문과 `COMMIT` 문 사이에 넣어, 트랜잭션의 시작과 끝을 표시한다.  
- 트랜잭션의 길이가 길어 트랜잭션의 중간 지점에 수정 내용을 반영하는 포인트인 SAVEPOINT와, ROLLBACK 명령어를 통해 중간에 작업이 잘못된 경우 회복 알고리즘을 이용해 변경한 내용을 취소할 수도 있다.

<br>

## LOCK
- 갱신손실(lost update) 문제란, 두 트랜잭션이 한 개의 데이터를 동신에 업데이트할 때 발생하는 문제로, 데이터베이스에서 절대 발생하면 안 되는 현상이다.
- 갱신손실 문제를 해결하기 위해, 트랜잭션이 데이터를 사용중임을 데이터에 표시하는 잠금 장치인 락(Lock)을 사용할 수 있다. 한 트랜잭션 T1이 업데이트 중인 row인 X에 락을 설정하면, 다른 트랜잭션 T2는 자신이 원하는 락을 얻지 못하고 대기한다. T1가 언락을 하면, 이후에 X에 대한 업데이트를 순차적으로 진행할 수 있다.
